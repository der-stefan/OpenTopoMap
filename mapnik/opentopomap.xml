<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE Map
[
       <!ENTITY world_boundaries_dir   "world_boundaries/">
       
       <!ENTITY world SYSTEM "inc-style/world.sty">
       <!ENTITY landuse-fill SYSTEM "inc-style/landuse-fill.sty">
       <!ENTITY relief SYSTEM "inc-style/relief.sty">
       <!ENTITY hillshade SYSTEM "inc-style/hillshade.sty">
       <!ENTITY residential-fill SYSTEM "inc-style/residential-fill.sty">
       <!ENTITY waterway-lines SYSTEM "inc-style/waterway-lines.sty">
       <!ENTITY waterway-polygons-casing SYSTEM "inc-style/waterway-polygons-casing.sty">
       <!ENTITY waterway-polygons-fill SYSTEM "inc-style/waterway-polygons-fill.sty">
       <!ENTITY water-areas SYSTEM "inc-style/water-areas.sty">
       <!ENTITY water-weir SYSTEM "inc-style/water-weir.sty">
       <!ENTITY tunnels-casing SYSTEM "inc-style/tunnels-casing.sty">
       <!ENTITY tunnels-fill SYSTEM "inc-style/tunnels-fill.sty">
       <!ENTITY tunnels-middle SYSTEM "inc-style/tunnels-middle.sty">
       <!ENTITY cliffs-draw SYSTEM "inc-style/cliffs-draw.sty">
       <!ENTITY buildings-fill SYSTEM "inc-style/buildings-fill.sty">
       <!ENTITY military-fill SYSTEM "inc-style/military-fill.sty">

       <!ENTITY contours SYSTEM "inc-style/contours.sty">
       <!ENTITY layer-contours SYSTEM "opentopomap_contours.include">
       
       <!ENTITY borders-draw SYSTEM "inc-style/borders-draw.sty">
       <!ENTITY railways-embankment SYSTEM "inc-style/railways-embankment.sty">
       <!ENTITY railways-draw SYSTEM "inc-style/railways-draw.sty">
       <!ENTITY airports-casing SYSTEM "inc-style/airports-casing.sty">
       <!ENTITY airports-fill SYSTEM "inc-style/airports-fill.sty">
       <!ENTITY roads-lowzoom-casing SYSTEM "inc-style/roads-lowzoom-casing.sty">
       <!ENTITY roads-lowzoom-fill SYSTEM "inc-style/roads-lowzoom-fill.sty">
       <!ENTITY roads-casing SYSTEM "inc-style/roads-casing.sty">
       <!ENTITY roads-fill SYSTEM "inc-style/roads-fill.sty">
       <!ENTITY roads-12_13 SYSTEM "inc-style/roads-12_13.sty"> 
       <!ENTITY roads-middle SYSTEM "inc-style/roads-middle.sty">
       <!ENTITY roads-text_z16 SYSTEM "inc-style/roads-text_z16.sty">
       <!ENTITY ferry_routes-draw SYSTEM "inc-style/ferry_routes-draw.sty">
       <!ENTITY railways-bridge SYSTEM "inc-style/railways-bridge.sty">
       <!ENTITY bridges-casing SYSTEM "inc-style/bridges-casing.sty">
       <!ENTITY bridges-fill SYSTEM "inc-style/bridges-fill.sty">
       <!ENTITY bridges-middle SYSTEM "inc-style/bridges-middle.sty">
       <!ENTITY aerialways-draw SYSTEM "inc-style/aerialways-draw.sty">
       <!ENTITY powerlines-draw SYSTEM "inc-style/powerlines-draw.sty">
       <!ENTITY powertowers-draw SYSTEM "inc-style/powertowers-draw.sty">
       <!ENTITY fences-draw SYSTEM "inc-style/fences-draw.sty">
       <!ENTITY text-capitals SYSTEM "inc-style/text-capitals.sty">
       <!ENTITY text-cities SYSTEM "inc-style/text-cities.sty">
       <!ENTITY text-towns SYSTEM "inc-style/text-towns.sty">
       <!ENTITY text-villages SYSTEM "inc-style/text-villages.sty">
       <!ENTITY text-natural SYSTEM "inc-style/text-natural.sty">
       <!ENTITY text-peaks SYSTEM "inc-style/text-peaks.sty">
       <!ENTITY symbols-churches-castles SYSTEM "inc-style/symbols-churches-castles.sty">
       <!ENTITY symbols-draw SYSTEM "inc-style/symbols-draw.sty">
       <!ENTITY symbols-pv SYSTEM "inc-style/symbols-pv.sty">
       <!ENTITY symbols-viewpoints SYSTEM "inc-style/symbols-viewpoints.sty">
       <!ENTITY text-roads SYSTEM "inc-style/text-roads.sty">
       <!ENTITY text-waterways SYSTEM "inc-style/text-waterways.sty">
       
       <!ENTITY % entities SYSTEM "inc/entities.xml.inc">
       %entities;
       
]>
<Map background-color="#75b0c1" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over" buffer-size="256">
<!-- style definitions -->
	&world;
	&landuse-fill;
    &relief;
	&hillshade;
	&residential-fill;
	&waterway-lines;
	&waterway-polygons-casing;
	&waterway-polygons-fill;
	&water-areas;
	&water-weir;
	&tunnels-casing;
	&tunnels-fill;
	&tunnels-middle;
	&cliffs-draw;
	&buildings-fill;
	&military-fill;
	&contours;
	&borders-draw;
	&railways-embankment;
	&railways-draw;
	&airports-casing;
	&airports-fill;
    &roads-lowzoom-casing;
    &roads-lowzoom-fill;
	&roads-casing;
	&roads-fill;
	&roads-12_13;
	&roads-middle;
    &roads-text_z16;
	&ferry_routes-draw;
	&railways-bridge;
	&bridges-casing;
	&bridges-fill;
	&bridges-middle;
	&aerialways-draw;
	&powerlines-draw;
	&powertowers-draw;
	&fences-draw;
    &text-capitals;
	&text-cities;
	&text-towns;
	&text-villages;
	&text-natural;
	&text-peaks;
	&symbols-churches-castles;
	&symbols-draw;
	&symbols-pv;
	&symbols-viewpoints;
	&text-roads;
	&text-waterways;

	<!-- layers -->
	<Layer name="world" status="on" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over">
		<StyleName>world</StyleName>
		<Datasource>
			<Parameter name="type">shape</Parameter>
			<Parameter name="file">&world_boundaries_dir;/shoreline_300</Parameter>
		</Datasource>
	</Layer>
	<Layer name="coast-poly" status="on" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over">
		<StyleName>coast-poly</StyleName>
		<Datasource>
			<Parameter name="type">shape</Parameter>
			<Parameter name="file">&world_boundaries_dir;/processed_p</Parameter>
		</Datasource>
	</Layer>
	  

	<Layer name="landuse">
		<StyleName>landuse-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,way_area,landuse,leisure,"natural",wetland,wood,amenity FROM &prefix;_polygon) AS landuse </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="relief" status="on">
		<StyleName>relief-5000</StyleName>
		<Datasource>
			<Parameter name="type">gdal</Parameter>
			<Parameter name="file">hillshade/relief-5000.tif</Parameter>
			<Parameter name="format">tiff</Parameter>
		</Datasource>
	</Layer>

	<Layer name="relief" status="on">
		<StyleName>relief-1000</StyleName>
		<Datasource>
			<Parameter name="type">gdal</Parameter>
			<Parameter name="file">hillshade/relief-500.tif</Parameter>
			<Parameter name="format">tiff</Parameter>
		</Datasource>
	</Layer>

	<Layer name="dem-2000" status="on">
		<StyleName>hillshade-2000</StyleName>
		<Datasource>
			<Parameter name="type">gdal</Parameter>
			<Parameter name="file">hillshade/hillshade-europe-2000.tif</Parameter>
			<Parameter name="format">tiff</Parameter>
		</Datasource>
	</Layer>

	<Layer name="dem-500" status="on">
		<StyleName>hillshade-500</StyleName>
		<Datasource>
			<Parameter name="type">gdal</Parameter>
			<Parameter name="file">hillshade/hillshade-europe-500.tif</Parameter>
			<Parameter name="format">tiff</Parameter>
		</Datasource>
	</Layer>

	<Layer name="dem-150" status="on">
		<StyleName>hillshade-150</StyleName>
		<Datasource>
			<Parameter name="type">gdal</Parameter>
			<Parameter name="file">hillshade/hillshade-europe-150.tif</Parameter>
			<Parameter name="format">tiff</Parameter>
		</Datasource>
	</Layer>
	  
	<Layer name="residential">
		<StyleName>residential-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,amenity,landuse FROM &prefix;_polygon WHERE landuse IN ('residential','industrial') OR amenity IN ('university','school','hospital')) AS landuse </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	  
	<Layer name="waterway-lines">
		<StyleName>waterway-lines</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"CEMT",intermittent,NULL AS motorboat,tunnel,waterway FROM &prefix;_line) AS water </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="water-polygons">
		<StyleName>waterway-polygons-casing</StyleName>
		<StyleName>waterway-polygons-fill</StyleName>
		<StyleName>water-areas</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"CEMT",NULL AS motorboat,"natural",landuse,leisure,waterway,way_area FROM &prefix;_polygon) AS water </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="water-weir">
		<StyleName>water-weir</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,waterway FROM &prefix;_line) AS water </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="tunnels">
		<StyleName>tunnels-casing</StyleName>
		<StyleName>tunnels-fill</StyleName>
		<StyleName>tunnels-middle</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway,tracktype FROM &prefix;_line WHERE (tunnel = 'yes') AND highway IS NOT NULL) AS roads </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="cliffs-lines">
		<StyleName>cliffs-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"natural","man_made",highway FROM &prefix;_line) AS cliff </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="cliffs-polygons">
		<StyleName>cliffs-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,area,"natural","man_made",NULL AS highway FROM &prefix;_polygon WHERE (area != 'yes')) AS cliff </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="buildings">
		<StyleName>buildings-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,building,leisure,railway,amenity,aeroway FROM &prefix;_polygon WHERE (building IS NOT NULL AND building != 'no') OR (aeroway = 'terminal')) AS buildings </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="military">
		<StyleName>military-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,landuse FROM &prefix;_polygon WHERE (landuse = 'military')) AS landuse </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>


	<!-- Insert contour lines and clear label cache after that -->
	&layer-contours;


	<Layer name="borders" clear-label-cache="yes">
		<StyleName>borders-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,boundary,admin_level FROM &prefix;_line WHERE boundary IN ('administrative')) AS borders </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="railways">
		<StyleName>railways-embankment</StyleName>
		<StyleName>railways-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,railway,tunnel,embankment FROM &prefix;_line WHERE railway IS NOT NULL) AS railways </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="airports">
		<StyleName>airports-casing</StyleName>
		<StyleName>airports-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,aeroway FROM &prefix;_line WHERE aeroway IS NOT NULL) AS airports </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	 
	<Layer name="roads-lowzoom">
		<StyleName>roads-lowzoom-casing</StyleName>
		<StyleName>roads-lowzoom-fill</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway FROM &prefix;_roads) AS roadslowzoom </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="roads-casing">
	<!-- draw only roads without bridges and tunnels, but above zoom 12 every road-->
	<StyleName>roads-casing</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway,surface,tracktype,embankment FROM &prefix;_line WHERE (!scale_denominator! &gt; 150000) OR ((bridge IS NULL OR bridge != 'yes') AND (tunnel IS NULL OR tunnel != 'yes')) AND highway IS NOT NULL) AS roads </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	  
	<Layer name="roads-fill">
		<StyleName>roads-fill</StyleName>
		<StyleName>roads-12_13</StyleName>
		<StyleName>roads-middle</StyleName>
		<StyleName>roads-text_z16</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway,tracktype,name FROM &prefix;_line WHERE (!scale_denominator! &gt; 150000) OR ((bridge IS NULL OR bridge != 'yes') AND (tunnel IS NULL OR tunnel != 'yes')) AND highway IS NOT NULL) AS roads </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	
	<Layer name="ferry_routes">
		<StyleName>ferry_routes-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,route FROM &prefix;_line) AS route </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	
	<Layer name="railways">
		<StyleName>railways-bridge</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,railway FROM &prefix;_line WHERE (bridge = 'yes') AND (railway IS NOT NULL)) AS railways </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	
	   
	<Layer name="bridges">
		<StyleName>bridges-casing</StyleName>
		<StyleName>bridges-fill</StyleName>
		<StyleName>bridges-middle</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway,tracktype FROM &prefix;_line WHERE (bridge = 'yes') AND (highway IS NOT NULL)) AS roads </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	 
	<Layer name="aerialways">
		<StyleName>aerialways-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,aerialway FROM &prefix;_line WHERE aerialway IS NOT NULL) AS aerialway </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="powerlines">
		<StyleName>powerlines-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,power,voltage FROM &prefix;_line) AS powerlines </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	<Layer name="powertowers">
		<StyleName>powertowers-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,power FROM &prefix;_point WHERE power IN ('tower','pole')) AS powertowers </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="fences-poly">
		<StyleName>fences-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,barrier,fenced FROM &prefix;_polygon WHERE (ST_Perimeter(way)::integer &gt; 400)) AS fences </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	<Layer name="fences-line">
		<StyleName>fences-draw</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,barrier,fenced FROM &prefix;_line WHERE (ST_Length(way)::integer &gt; 300)) AS fences </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="text">
		<StyleName>text-capitals</StyleName>
		<StyleName>text-cities</StyleName>
		<StyleName>text-towns</StyleName>
		<StyleName>text-villages</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,name,capital,place,population::INTEGER FROM &prefix;_point WHERE place IN ('city','town','village','suburb','hamlet') AND (population IS NULL OR population SIMILAR TO '[[:digit:]]+') order by (CASE WHEN place='city' THEN 0 WHEN place='town' THEN 1 WHEN place='village' THEN 2 ELSE 3 END) asc, (CASE WHEN population IS NUll THEN 0 WHEN population similar to '[[:digit:]]+' THEN population::integer ELSE 0 END) desc
		  ) AS names</Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	  
	<Layer name="text-natural">
		<StyleName>text-natural</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,name,"natural",way_area FROM &prefix;_polygon) AS names</Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="text-peaks">
		<StyleName>text-peaks</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,name,"natural",ele FROM &prefix;_point) AS names</Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="symbols-poly">
		<StyleName>symbols-churches-castles</StyleName>
		<StyleName>symbols-draw</StyleName>
		<StyleName>symbols-pv</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,access,amenity,historic,castle_type,religion,denomination,denotation,"man_made","tower:type","communication:radio","communication:television",building,"natural",name,ruins,null AS "summit:cross",tourism,"power","generator:source","site_type",sport,type,disused,abandoned,railway,way_area FROM &prefix;_polygon) AS symbols </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

	<Layer name="symbols-point">
		<StyleName>symbols-churches-castles</StyleName>
		<StyleName>symbols-draw</StyleName>
		<StyleName>symbols-viewpoints</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,access,amenity,historic,castle_type,religion,denomination,denotation,"man_made","tower:type","communication:radio","communication:television",building,"natural",name,ruins,"summit:cross",tourism,"power","generator:source","site_type",sport,type,disused,abandoned,railway FROM &prefix;_point) AS symbols </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	  
	<Layer name="text-roads">
		<StyleName>text-roads</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,highway,ref FROM &prefix;_line WHERE (ST_Length(way)::integer &gt; 1000) AND ref IS NOT NULL) AS roads </Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>
	
	<Layer name="text-waterways">
		<StyleName>text-waterways</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,name,waterway FROM &prefix;_line) AS names</Parameter>
			&datasource-settings;
		</Datasource>
	</Layer>

</Map>

<!--
macros:
	!scale_denominator!
	!bbox!
-->
